<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Speech-Language Therapy Goal Report - {{ patient.name }}</title>
<style>
    @page {
        size: letter;
        margin: 0.6in;
    }

    body {
        font-family: "Helvetica", "Arial", sans-serif;
        font-size: 10pt;
        color: #222;
        line-height: 1.45;
        margin: 0;
        padding: 0;
    }

    /* ===== HEADER ===== */
    .header {
        padding-bottom: none;
        margin-bottom: none;
    }

    .header h1 {
        font-size: 16pt;
        color: #2c3e50;
        margin: 0 0 4px 0;
        font-weight: bold;
        letter-spacing: 0.5px;
    }

    .patient-info {
        font-size: 9pt;
        color: #444;
    }

    .info-row {
        margin: 0px 0;
    }

    .label {
        font-weight: bold;
        color: #000;
        display: inline-block;
        width: 0px;
    }

    /* ===== GOAL SECTION ===== */
    .goal-section {
        margin-bottom: none;
        page-break-inside: avoid;
    }

    .goal-title {
        font-size: 12pt;
        font-weight: bold;
        color: #2c3e50;
        margin: 0;
        display: inline-block;
    }

    .status {
        font-size: 9pt;
        font-weight: bold;
        text-transform: capitalize;
        float: right;
        padding: 2px 6px;
        border-radius: 3px;
        color: #fff;
    }
    .status-active { background-color: #6c757d; }
    .status-achieved { background-color: #28a745; }
    .status-on_hold { background-color: #ffc107; color: #000; }
    .status-discontinued { background-color: #dc3545; }

    .section-block {
        margin-top: 10px;
    }

    .goal-block {
        margin-top: 10px;
    }

    .goal-text {
        font-size: 9.5pt;
        color: #222;
        margin-left: 8px;
        padding-bottom: 10px;
    }

    .section-label {
        font-weight: bold;
        text-transform: uppercase;
        font-size: 9pt;
        letter-spacing: 0.3px;
        color: #2c3e50;
        margin-bottom: 3px;
    }

    .section-text {
        font-size: 9.5pt;
        color: #222;
        margin-left: 8px;
    }

    .intervention-text {
        white-space: pre-wrap;
        font-size: 9.5pt;
        background-color: #f8f9fa;
        padding: 6px 8px;
        border-left: 3px solid #2c3e50;
        margin: 4px 0 6px 8px;
        color: #111;
    }

    .date-info {
        margin-top: 10px;
        font-size: 8.5pt;
        color: #555;
        font-style: italic;
    }

    /* ===== SIGNATURE ===== */
    .signature-section {
        margin-top: 0.2in;     /* spacing above signature area */
        text-align: left;      /* align to left edge */
    }

    .sig-liner {
        width: 45%;
        border-top: 1px solid #000;
        height: 1px;            /* force the line to appear */
        margin-bottom: 4px;     /* small space before label */
    }

    .sig-line {
        display: inline-block;
        width: 45%;            /* adjust width as needed (40â€“50% looks balanced) */
        border-top: 1px solid #000;
        padding-top: 3px;
        font-size: 8pt;
        color: #444;
        text-align: center;    /* centers the text under the line */
    }

    /* ===== FOOTER ===== */
    .footer {
        text-align: center;
        font-size: 8pt;
        color: #666;
        border-top: 1px solid #aaa;
        margin-top: 0.7in;
        padding-top: 6px;
    }

    .checkbox {
        display: inline-block;
        width: 11px;
        height: 11px;
        border: 1px solid #000;
        margin-right: 6px;
        vertical-align: middle;
    }

    h2, h3, h4 {
        page-break-after: avoid;
    }
</style>
</head>
<body>

    <!-- HEADER -->
    <div class="header">
        <h1>Speech-Language Therapy Goal Report</h1>
        <div class="patient-info">
            <div class="info-row"><span class="label">Patient:&nbsp; </span>{{ patient.name }}</div>
            <div class="info-row"><span class="label">Date of Birth: &nbsp;</span>{{ patient.dob }}</div>
            <div class="info-row"><span class="label">Report Date: &nbsp;</span>{{ current_time.strftime('%B %d, %Y') }}</div>
            <div class="info-row"><span class="label">Clinician: &nbsp;</span>{{ slp.username }}</div>
        </div>
        <hr>
    </div>

    <!-- GOAL SECTION -->
    <div class="goal-section">
        <div class="goal-header">
            <span class="checkbox"></span>
            <span class="goal-title">{{ goal.goal_text }}&nbsp;&nbsp;</span>
            <span class="status 
                {% if goal.status == 'active' %}status-active
                {% elif goal.status == 'achieved' %}status-achieved
                {% elif goal.status == 'on_hold' %}status-on_hold
                {% elif goal.status == 'discontinued' %}status-discontinued
                {% endif %}">
                {{ goal.status.replace('_', ' ') }}
            </span>
        </div>

        {% if goal.problem_description %}
        <div class="section-block">
            <div class="section-label">Problem Description</div>
            <div class="section-text">{{ goal.problem_description }}</div>
        </div>
        {% endif %}

        {% if goal.intervention_text %}
        <div class="section-block">
            <div class="section-label">Intervention Strategy</div>
            <div class="intervention-text">{{ goal.intervention_text | format_intervention }}</div>
        </div>
        {% endif %}

        {% if goal.goal_notes %}
        <div class="goal-block">
            <div class="section-label">Clinical Notes</div>
            <div class="goal-text">{{ goal.goal_notes }}</div>
        </div>
        {% endif %}

        <div class="date-info">
            Goal established: {{ goal.created_at.strftime('%B %d, %Y') }}
            {% if goal.achieved_at %}| Achieved: {{ goal.achieved_at.strftime('%B %d, %Y') }}{% endif %}
        </div>
    </div>

    <!-- SIGNATURE -->
    <div class="signature-section">
        <div class="sig-liner"></div>
        <div class="sig-line">Speech-Language Pathologist Signature</div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        This report contains protected health information. Unauthorized disclosure is prohibited.
    </div>

</body>
</html>
